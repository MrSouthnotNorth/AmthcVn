<!doctype html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Ẩm thực Việt Nam</title>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&family=Nunito:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root{
            --accent:#7aa26b;
            --muted:#f5f3ef;
            --card:#fff;
            --glass: rgba(255,255,255,0.85);
            --radius:14px;
            --shadow: 0 6px 18px rgba(0,0,0,0.08);
            --transition: 300ms cubic-bezier(.2,.9,.3,1);
        }
        *{box-sizing:border-box}
        body{
            margin:0;
            font-family: "Nunito",system-ui,Segoe UI, Roboto, "Helvetica Neue", Arial;
            background: linear-gradient(180deg,#fffef8 0%, #f7f7f5 100%);
            color:#222;
            -webkit-font-smoothing:antialiased;
        }

        /* Header */
        header{
            display:flex;
            align-items:center;
            gap:20px;
            padding:18px 24px;
            position:relative;
            background: linear-gradient(90deg, rgba(250,248,243,0.9), rgba(255,255,255,0.6));
            border-bottom:1px solid #eee;
            z-index:10;
        }
        .logo{
            width:64px;height:64px;border-radius:8px;overflow:hidden;
            background:linear-gradient(45deg,#e6f1df,#cfe8c1);
            display:flex;align-items:center;justify-content:center;
            flex:0 0 64px; border:2px solid rgba(0,0,0,0.04);
        }
        .logo img{width:100%;height:100%;object-fit:cover;display:block}
        h1{
            margin:0;
            flex:1;
            text-align:center;
            font-family:"Merriweather", serif;
            font-weight:700;
            font-size:28px;
            color:#3b4b2f;
            text-shadow: 0 1px 0 rgba(255,255,255,0.6);
            letter-spacing:0.6px;
        }
        header .dec{
            width:64px;height:64px;opacity:0.9;background:transparent;
            display:flex;align-items:center;justify-content:center;
            color:var(--accent);font-size:20px;
        }

        /* Carousel */
        .hero{
            padding:18px;
            display:flex;
            justify-content:center;
        }
        .carousel{
            width:100%;
            max-width:1100px;
            height:360px;
            overflow:hidden;
            border-radius:16px;
            box-shadow: var(--shadow);
            position:relative;
            background:linear-gradient(180deg,#efe8dc,#fff);
        }
        .slides{
            display:flex;
            height:100%;
            transition: transform 700ms ease;
            will-change: transform;
        }
        .slide{
            flex:0 0 100%;
            height:100%;
            position:relative;
            overflow:hidden;
        }
        .slide img{
            width:100%;
            height:100%;
            object-fit:cover;
            display:block;
            transition: transform 600ms var(--transition);
        }
        .slide:hover img{ transform: scale(1.04); } /* hover zoom nhẹ */

        /* slide overlay style (bamboo + stork motifs as subtle decorations) */
        .slide::after{
            content:"";
            position:absolute;
            inset:0;
            background-image:
                radial-gradient(circle at 10% 20%, rgba(255,255,255,0.03) 0 15%, transparent 15%),
                linear-gradient(180deg, rgba(255,255,255,0.02), transparent 40%);
            pointer-events:none;
        }
        .carousel-controls{
            position:absolute;
            left:12px;right:12px;bottom:12px;
            display:flex;justify-content:space-between;align-items:center;
            pointer-events:none;
        }
        .dots{display:flex;gap:8px;pointer-events:auto}
        .dot{
            width:10px;height:10px;border-radius:10px;background:rgba(0,0,0,0.12);
            transition:all 220ms;
        }
        .dot.active{background:var(--accent);transform:scale(1.15)}
        .control-btn{
            pointer-events:auto;background:rgba(255,255,255,0.85);border-radius:10px;padding:8px;
            box-shadow:var(--shadow);cursor:pointer;border:0;
        }

        /* Tabs menu */
        nav.tabs{
            margin:18px auto 6px;
            max-width:1100px;
            display:flex;
            gap:8px;flex-wrap:wrap;
            padding:8px;
        }
        nav.tabs button{
            background:var(--glass);
            border:1px solid rgba(0,0,0,0.06);
            padding:10px 14px;border-radius:12px;
            cursor:pointer;font-weight:600;color:#333;
            transition:all 180ms;
        }
        nav.tabs button.active{background:var(--accent);color:#fff;transform:translateY(-3px)}
        .content{
            max-width:1100px;margin:12px auto;padding:18px;background:transparent;
        }
        .pane{display:none}
        .pane.active{display:block}

        /* Intro */
        .intro{
            display:flex;gap:18px;align-items:center;
            background:linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.4));
            padding:16px;border-radius:12px;box-shadow:var(--shadow);
        }
        .intro img{width:220px;height:140px;object-fit:cover;border-radius:10px}
        .intro .txt{flex:1;color:#333}

        /* Menu grid */
        .searchbar{display:flex;gap:10px;align-items:center;margin:10px 0}
        .searchbar input{
            flex:1;padding:10px 12px;border-radius:10px;border:1px solid #e3e3e3;background:#fff;
        }
        .grid{
            display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px;margin-top:12px;
        }
        .card{
            background:var(--card);border-radius:12px;padding:10px;box-shadow:var(--shadow);
            transition:transform 260ms,var(--transition);
            cursor:pointer;border:1px solid rgba(0,0,0,0.03);
            display:flex;flex-direction:column;gap:10px;
        }
        .card:hover{transform:translateY(-6px)}
        .card .imgwrap{
            height:140px;border-radius:10px;overflow:hidden;
        }
        .card img{width:100%;height:100%;object-fit:cover;display:block;transition:transform 300ms}
        .card:hover img{transform:scale(1.1)} /* zoom 10% on hover */
        .card h3{margin:0;font-size:16px;color:#2c3b2b}
        .card p{margin:0;color:#566;flex:1;font-size:13px}

        /* modal */
        .modal{
            position:fixed;inset:0;display:none;align-items:center;justify-content:center;
            background:rgba(0,0,0,0.4);z-index:50;padding:20px;
        }
        .modal.active{display:flex}
        .dialog{
            width:100%;max-width:820px;background:#fff;border-radius:14px;padding:18px;box-shadow:0 18px 60px rgba(0,0,0,0.3);
            max-height:90vh;overflow:auto;
        }
        .dialog .top{display:flex;gap:14px}
        .dialog .top img{width:260px;height:160px;object-fit:cover;border-radius:10px}
        .dialog h2{margin:0 0 6px}
        .variants, .toppings{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
        .chip{background:#f2f7ef;padding:6px 10px;border-radius:999px;border:1px solid rgba(0,0,0,0.04);font-size:13px}

        /* comments box */
        .comments{
            margin-top:14px;border-radius:10px;padding:10px;background:#fafafa;border:1px solid #eee;
            max-height:180px;overflow:auto;
        }
        .cmt{padding:8px;border-bottom:1px dashed rgba(0,0,0,0.04);font-size:14px}
        .cmt:last-child{border-bottom:0}

        /* comment preview on menu card: single visible comment with avatar + name + smooth scroll */
        .comment-preview{ display:flex; align-items:center; gap:10px; margin-top:8px; }
        .comment-preview .cavatar{
            width:44px; height:44px; min-width:44px; border-radius:50%;
            background:linear-gradient(180deg,var(--accent), #5f9b6a);
            color:#fff; display:grid; place-items:center; font-weight:700; font-size:16px;
            box-shadow:var(--shadow);
        }
        .comment-preview .cmeta{ flex:1; background:#fff; padding:8px 10px; border-radius:8px; box-shadow:var(--shadow); font-size:13px; color:#333; }
        .comment-preview .cmeta .cname{ font-weight:700; font-size:13px; color:#2c3b2b; margin-bottom:4px; }
        /* smooth, snap-scrolling comment area */
        .comment-preview .cmeta .ctext{
            font-size:13px;
            color:#444;
            max-height:48px;
            height:48px;
            overflow:auto;
            scroll-behavior:smooth;
            scroll-snap-type:y mandatory;
            -webkit-overflow-scrolling: touch; /* smoother momentum on mobile */
        }
        .comment-preview .cmeta .ctext::-webkit-scrollbar{ width:8px; height:6px; }
        .comment-preview .cmeta .ctext::-webkit-scrollbar-thumb{ background:rgba(0,0,0,0.08); border-radius:8px; }
        .comment-preview .cmeta .ctext .citem{
            scroll-snap-align:start;
            min-height:48px;
            display:flex;
            align-items:center;
            padding:2px 0;
            line-height:1.2;
        }
         .card .comment-preview{ margin-top:auto } /* keep preview near bottom of card */

        /* footer notices for unfinished tabs */
        .coming{padding:30px;text-align:center;color:#666;background:linear-gradient(180deg,#fff,#fbfbfb);border-radius:12px;border:1px dashed #eee}

        @media (max-width:700px){
            .intro{flex-direction:column}
            .dialog .top{flex-direction:column}
            .dialog .top img{width:100%;height:200px}
            h1{font-size:22px}
            .carousel{height:240px}
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <!-- Thay ảnh logo của bạn tại đây -->
            <img src="https://media.loveitopcdn.com/3807/la-co-viet-nam-dongphusongphu2.png" alt="logo">
        </div>
        <h1>Ẩm thực Việt Nam</h1>
        <div class="dec" title="Trang trí">🏯</div>
    </header>

    <section class="hero">
        <div class="carousel" id="carousel">
            <div class="slides" id="slides">
                <!-- 7 slide (placeholder images). Bạn có thể thay src bằng ảnh thật -->
                <div class="slide"><img src="https://media.vietravel.com/images/Content/am-thuc-viet-nam-thuoc-top-ngon-nhat-the-gioi-104749.jpg" alt=""></div>
                <div class="slide"><img src="https://www.bonboncar.vn/blog/content/images/2025/08/pho-bo-ha-noi.jpeg" alt=""></div>
                <div class="slide"><img src="https://cdn2.fptshop.com.vn/unsafe/1920x0/filters:format(webp):quality(75)/2023_3_4_638135494683018162_cach-lam-bun-cha-bang-noi-chien-khong-dau-1.jpg" alt=""></div>
                <div class="slide"><img src="https://i-giadinh.vnecdn.net/2024/03/07/7Honthinthnhphm1-1709800144-8583-1709800424.jpg" alt=""></div>
                <div class="slide"><img src="https://cdn.tcdulichtphcm.vn/upload/1-2024/images/2024-03-15/1710445729-picture-1-1710445636-793-width1200height900.jpg" alt=""></div>
                <div class="slide"><img src="https://nhahangcontoc.com/wp-content/uploads/2023/03/banh-bot-loc-2-093047ad.jpg" alt=""></div>
                <div class="slide"><img src="https://i.ytimg.com/vi/CSI9ildGX9s/maxresdefault.jpg" alt=""></div>
            </div>

            <div class="carousel-controls">
                <div class="left-controls" style="display:flex;gap:8px;">
                    <button class="control-btn" id="prev" title="Trước">◀</button>
                    <button class="control-btn" id="next" title="Tiếp">▶</button>
                </div>
                <div class="dots" id="dots"></div>
            </div>
        </div>
    </section>

    <nav class="tabs" role="tablist" aria-label="Main menu">
        <button class="tab-btn active" data-target="intro">Giới thiệu</button>
        <button class="tab-btn" data-target="menu">Thực đơn</button>
        <button class="tab-btn" data-target="reviews">Đánh giá</button>
        <button class="tab-btn" data-target="order">Đặt hàng</button>
        <button class="tab-btn" data-target="contact">Liên hệ</button>
        <button class="tab-btn" data-target="support">Hỗ trợ</button>
    </nav>

    <main class="content">
        <section id="intro" class="pane active">
            <div class="intro">
                <img src="https://media-cdn-v2.laodong.vn/Storage/NewsPortal/2023/9/29/1247753/Am-Thuc-Viet-Nam.jpeg" alt="Giới thiệu">
                <div class="txt">
                    <h3>Giới thiệu ẩm thực truyền thống Việt Nam</h3>
                    <p>
                        Ẩm thực Việt Nam đa dạng với các món phở, bún, bánh mì, chả, ram... Được chế biến từ nguyên liệu tươi,
                        gia vị tinh tế, và sáng tạo theo vùng miền. Mỗi món ăn mang hương vị đặc trưng, phản ánh văn hóa và lịch sử phong phú của đất nước.
                    </p>
                </div>
            </div>
        </section>

        <section id="menu" class="pane">
            <div style="display:flex;flex-direction:column">
                <div class="searchbar">
                    <input id="search" placeholder="Tìm món (ví dụ: Phở, Bánh Mì...)">
                    <div style="width:130px;text-align:right;color:#666;font-size:14px">Kéo để xem thêm</div>
                </div>

                <div class="grid" id="menuGrid">
                    <!-- Cards sẽ được sinh động bằng JS -->
                </div>
            </div>
        </section>

        <section id="reviews" class="pane">
            <h3>Đánh giá người dùng</h3>
            <div class="review-list" id="reviewList">
                <!-- JS will render -->
            </div>
        </section>

        <section id="order" class="pane">
            <div class="coming">Đang trong quá trình hoàn thiện, xin thông cảm.</div>
        </section>

        <section id="contact" class="pane">
            <div class="coming">Đang trong quá trình hoàn thiện, xin thông cảm.</div>
        </section>

        <section id="support" class="pane">
            <div class="coming">Đang trong quá trình hoàn thiện, xin thông cảm.</div>
        </section>
    </main>

    <!-- Modal for dish details -->
    <div class="modal" id="modal">
        <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="dlgTitle">
            <div style="display:flex;justify-content:space-between;align-items:center">
                <div>
                    <h2 id="dlgTitle">Tên món</h2>
                    <div id="dlgRating" style="color:#f5a623;font-weight:700;margin-top:4px"></div>
                </div>
                <button id="closeDlg" style="background:transparent;border:0;font-size:20px;cursor:pointer">✕</button>
            </div>
            <div class="top">
                <img id="dlgImg" src="https://via.placeholder.com/400x260.png?text=Ảnh" alt="">
                <div style="flex:1">
                    <p id="dlgDesc" style="color:#444">Mô tả ngắn về món ăn.</p>
                    <div style="margin-top:10px">
                        <div style="font-weight:700;color:#333;margin-bottom:6px">Biến tấu</div>
                        <div id="dlgVars" class="variants"></div>
                        <div style="font-weight:700;color:#333;margin-top:12px;margin-bottom:6px">Topping / Thêm</div>
                        <div id="dlgTops" class="toppings"></div>
                    </div>
                </div>
            </div>

            <div style="margin-top:12px;font-weight:700">Bình luận tiêu biểu</div>
            <div class="comments" id="dlgComments">
                <!-- comments rendered here (with reviewer name + avatar + rating) -->
            </div>
        </div>
    </div>

    <script>
        // Data for menu (thay src bằng ảnh của bạn)
        const dishes = [
            { id:1, name:"Phở", img:"https://cdn2.fptshop.com.vn/unsafe/1920x0/filters:format(webp):quality(75)/2024_1_26_638418715174070559_pho-bo-anh-dai-dien.jpg", desc:"Phở truyền thống Hà Nội với nước dùng trong, thơm vị xương.", variants:["Phở tái","Phở gà","Phở nạm"], toppings:["Chanh","Ớt","Hành ngò"], comments:[
                {name:"Lan", text:"Ngon chuẩn vị!", rating:5},
                {name:"Minh", text:"Nước dùng thanh, thơm.", rating:5},
                {name:"An", text:"Phục vụ nhanh, bánh phở mềm.", rating:4},
                {name:"Hà", text:"Giá hợp lý, sẽ quay lại.", rating:5},
                {name:"Trung", text:"Đậm đà, rất vừa miệng.", rating:5}
            ], rating:4.7},
            { id:2, name:"Bánh Mì", img:"https://cdn2.fptshop.com.vn/unsafe/1920x0/filters:format(webp):quality(75)/2024_2_19_638439762164888519_cach-lam-banh-mi-pate-trung-7.jpg", desc:"Bánh mì giòn rụm, nhân pha trộn chả, pate và rau thơm.", variants:["Bánh mì chả","Bánh mì đặc biệt"], toppings:["Pate","Ớt","Rau thơm"], comments:[
                {name:"Phúc", text:"Bánh giòn, nhân ngon.", rating:5},
                {name:"Mai", text:"Tuyệt vời cho bữa sáng.", rating:4},
                {name:"Quang", text:"Bỏ nhiều rau, tươi.", rating:4},
                {name:"Linh", text:"Nước sốt đậm đà.", rating:5},
                {name:"Hùng", text:"Phục vụ thân thiện.", rating:4}
            ], rating:4.5},
            { id:3, name:"Bún Chả", img:"https://cdn2.fptshop.com.vn/unsafe/1920x0/filters:format(webp):quality(75)/2024_1_12_638406880045931692_cach-lam-bun-cha-ha-noi-0.jpg", desc:"Bún chả Hà Nội với chả nướng than hoa, nước chấm cầu kỳ.", variants:["Thịt nạc","Thịt mỡ"], toppings:["Đu đủ chua ngọt","Rau thơm"], comments:[
                {name:"Hùng", text:"Đậm đà hương than.", rating:5},
                {name:"Mai", text:"Chấm rất vừa miệng.", rating:4},
                {name:"An", text:"Phục vụ ổn.", rating:4},
                {name:"Vy", text:"Quán đông giờ trưa.", rating:4},
                {name:"Ngọc", text:"Sẽ giới thiệu cho bạn bè.", rating:5}
            ], rating:4.6},
            { id:4, name:"Ram", img:"https://timtour.vn/files/images/AnGiNgon/Ram-thit-nuong-quang-ngai(2).jpg", desc:"Ram giòn, nhân tôm hoặc thịt, chấm tương cay.", variants:["Ram tôm","Ram thịt"], toppings:["Tương","Ớt"], comments:[
                {name:"Bảo", text:"Giòn rụm!", rating:5},
                {name:"Thu", text:"Nhân nhiều và đậm vị.", rating:4},
                {name:"Tú", text:"Ăn kèm rau sống hợp lý.", rating:4},
                {name:"Hà", text:"Món khai vị tuyệt.", rating:5},
                {name:"Thanh", text:"Phù hợp mọi lứa tuổi.", rating:4}
            ], rating:4.3},
            { id:5, name:"Chả dò", img:"https://www.google.com/search?sca_esv=78ad4a18d554e8c3&sxsrf=AE3TifNxX3fVGmaExy2IYASzbRooyEvycw:1760866449340&udm=2&fbs=AIIjpHyNLa7NbKa1H9FnKAJNsjCPuuyZ8axF70qppVREZw12J16j6TEYGEwZz6y4Q0FA_xM6YHD0TlzwvZm1rreNQvouQoF2_dc5xbJGrNcQh0JONbkndWU5v1cPI6lFx_rJr6uYFNQAitLBG9Fb8WaGsPzBRGhCBqtz2Uy56r5RcfJBY4BItARtcf4SUQ94qPpxdBnPt_70a5oOIrsi2Uba2r_MC0IFKjo-BkWZ3UFtOlLz_evgvi7U9P3-e8tYinTwqkU4Fiun&q=ch%E1%BA%A3+gi%C3%B2&sa=X&ved=2ahUKEwin0dbZ-q-QAxVQkK8BHWgoImYQtKgLegQIERAB&biw=385&bih=746&dpr=2.81#sv=CAMS9AQa1AQKhgIKuQEStgEKd0FMa3RfdkUtTEg0TzlRTmsxaHRoN1pnOWVNaEhrVF9qUGxLUGJGOXp2OC1Qa3lkT3lxQ2cxQ2tzbTBUQTVxUUpZTE5MeWZ1cTc5dng0eDBEVzNYaS0wRnhTZlpKckJFTnRXQ1oxYkVCOFZPbHkwREczNmZLWHhnEhdrckQwYU5lWEpMalUxZThQM3ZfMDJRNBoiQUZNQUdHcmNsYjNJOTNIazBpd2ZZOGQyMXlrU3AtS3BLURIDODQ5GgEzIg8KAXESCmNo4bqjIGdpw7IiBwoDdGJzEgAiJgoEZXFsZBIeQ2dJSUFCQUFPZ1FJQUJBQVZTN2hKajl0Tjk0a1B3ErYCCs8BEswBCowBQUxrdF92SG5fRVZRLUdyN2FnUTg4S0JkMDlpZDR2a21pQUtmSWcwUE5IX0ZJZWpYbnVuY2RyOGdIbUFXVkVtTUs3MklCVTBPYVJxWTlvdG4xdlVkUEo3M2h4V3pTYkttMmVUU3J5Y0FhZHZZYXJmTHlnZ2xleTgtOEdEb3J6WFJvdUd3OHFpSWdsMzISF2tyRDBhTmVYSkxqVTFlOFAzdl8wMlE0GiJBRk1BR0dwR2RQZElDNURzSmd4MXBBdElvcnlQdGdTWnRREgQ0Njk4GgEzIhgKBmltZ2RpaRIOMkU5UTJvUnE5NnY2Vk0iFwoFZG9jaWQSDkh6X2VhLXJ6aFIydnVNIiYKBGVxbGQSHkNnSUlBQkFBT2dRSUFCQUFWUzdoSmo5dE45NGtQdyoQZS0yRTlRMm9ScTk2djZWTSAEKhcKAXMSEGUtMkU5UTJvUnE5NnY2Vk0YATABGAcgyrypmgowAUoKCAIQAhgCIAIoAg", desc:"Chả truyền thống với gia vị đặc trưng.", variants:["Chiên","Hấp"], toppings:["Tỏi","Nước chấm"], comments:[
                {name:"Nga", text:"Chả thơm ngon.", rating:4},
                {name:"Dương", text:"Vị đậm đà.", rating:4},
                {name:"Hương", text:"Ăn cùng cơm rất hợp.", rating:4},
                {name:"Minh", text:"Phục vụ chu đáo.", rating:5},
                {name:"Kiên", text:"Giá hơi cao chút.", rating:3}
            ], rating:4.2},
            { id:6, name:"Bún bò Huế", img:"https://i.ytimg.com/vi/CSI9ildGX9s/maxresdefault.jpg", desc:"Nước dùng cay nồng đặc trưng Huế, bún mềm.", variants:["Bún bò đặc biệt","Bún bò chay"], toppings:["Giò heo","Hành lá","Ớt"], comments:[
                {name:"Huệ", text:"Vị cay chuẩn Huế.", rating:5},
                {name:"Long", text:"Nước dùng đậm đà.", rating:4},
                {name:"Hùng", text:"Thịt mềm.", rating:4},
                {name:"Vân", text:"Nêm vừa ăn.", rating:4},
                {name:"Nam", text:"Khẩu vị miền Trung rõ rệt.", rating:5}
            ], rating:4.4},
            { id:7, name:"Bánh bột lọc", img:"https://i.ytimg.com/vi/cIW9IrNk-5w/hq720.jpg?sqp=-oaymwEhCK4FEIIDSFryq4qpAxMIARUAAAAAGAElAADIQj0AgKJD&rs=AOn4CLBoydZw5qQrUU3i3fWMqwxdHa-iQA", desc:"Bánh bột lọc nhân tôm thịt, dai ngon.", variants:["Gói lá chuối","Hấp"], toppings:["Ớt chấm","Lá húng"], comments:[
                {name:"Hương", text:"Nhân đầy đặn.", rating:5},
                {name:"Lan", text:"Vị ngon truyền thống.", rating:4},
                {name:"Khoa", text:"Phù hợp ăn nhẹ.", rating:4},
                {name:"Tiến", text:"Gói đẹp mắt.", rating:4},
                {name:"Phương", text:"Ăn nóng ngon hơn.", rating:5}
            ], rating:4.5}
        ];

        // Render carousel dots
        const slidesEl = document.getElementById('slides');
        const dotsEl = document.getElementById('dots');
        const slideCount = slidesEl.children.length;
        let current = 0;
        for(let i=0;i<slideCount;i++){
            const d = document.createElement('div'); d.className='dot'; if(i===0) d.classList.add('active');
            d.dataset.index = i;
            d.addEventListener('click', ()=>{ goTo(parseInt(d.dataset.index)); resetAuto(); });
            dotsEl.appendChild(d);
        }
        function updateDots(){ [...dotsEl.children].forEach((d,i)=>d.classList.toggle('active', i===current)); }
        function goTo(i){
            current = (i+slideCount)%slideCount;
            slidesEl.style.transform = `translateX(-${current*100}%)`;
            updateDots();
        }
        document.getElementById('prev').addEventListener('click', ()=>{ goTo(current-1); resetAuto(); });
        document.getElementById('next').addEventListener('click', ()=>{ goTo(current+1); resetAuto(); });

        // auto slide every 5s
        let autoId = setInterval(()=> goTo(current+1), 5000);
        function resetAuto(){ clearInterval(autoId); autoId = setInterval(()=> goTo(current+1), 5000); }

        // Tabs logic
        document.querySelectorAll('.tab-btn').forEach(btn=>{
            btn.addEventListener('click', ()=>{
                document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
                btn.classList.add('active');
                const tgt = btn.dataset.target;
                document.querySelectorAll('.pane').forEach(p=>p.classList.remove('active'));
                document.getElementById(tgt).classList.add('active');
            });
        });

        // Render menu grid
        const grid = document.getElementById('menuGrid');
        function renderGrid(list){
            grid.innerHTML='';
            list.forEach(d=>{
                const card = document.createElement('article');
                card.className='card';
                card.dataset.id = d.id;
                card.innerHTML = `
                    <div class="imgwrap"><img src="${d.img}" alt="${d.name}"></div>
                    <h3>${d.name}</h3>
                    <p>${d.desc}</p>
                    <div class="comment-preview" aria-live="polite" tabindex="0">
                        <div class="cavatar" aria-hidden="true"></div>
                        <div class="cmeta"><div class="cname"></div><div class="ctext"></div></div>
                    </div>
                `;
                card.addEventListener('click', ()=> openDish(d.id));
                grid.appendChild(card);

                // initialize per-card comment carousel (single visible comment)
                (function initCardComments(cardEl, data){
                    const comments = Array.isArray(data.comments) ? data.comments : [];
                    const cavatar = cardEl.querySelector('.cavatar');
                    const cname = cardEl.querySelector('.cname');
                    const ctext = cardEl.querySelector('.ctext');
                    const preview = cardEl.querySelector('.comment-preview');

                    if(!comments.length){
                        cname.textContent = 'Chưa có bình luận';
                        ctext.innerHTML = '';
                        cavatar.textContent = '';
                        return;
                    }

                    // populate scrollable items for smooth/snapping behavior
                    ctext.innerHTML = '';
                    comments.forEach(c=>{
                        const item = document.createElement('div');
                        item.className = 'citem';
                        item.textContent = c.text;
                        ctext.appendChild(item);
                    });

                    // derive display name from comment object
                    const deriveName = (c, i)=>{
                        if(c && c.name) return String(c.name).slice(0,24);
                        const parts = String(c?.text || '').trim().split(/[.!?…]/)[0].split(' ').slice(0,2).join(' ');
                        return parts || `Người ${i+1}`;
                    };

                    let idx = 0;
                    // update avatar/name based on visible index
                    function updateMeta(i){
                        const clamped = (i + comments.length) % comments.length;
                        const name = deriveName(comments[clamped], clamped);
                        cname.textContent = name;
                        cavatar.textContent = (name.trim().charAt(0) || 'U').toUpperCase();
                        idx = clamped;
                    }

                    // on scroll, compute nearest item index and update meta; snap once scroll stops
                    let raf = null, scrollEndTimer = null;
                    function onScroll(){
                        if(raf) cancelAnimationFrame(raf);
                        raf = requestAnimationFrame(()=>{
                            const itemEl = ctext.querySelector('.citem');
                            const h = itemEl ? itemEl.offsetHeight : 48;
                            const newIdx = Math.round(ctext.scrollTop / h);
                            updateMeta(newIdx);
                        });
                        if(scrollEndTimer) clearTimeout(scrollEndTimer);
                        scrollEndTimer = setTimeout(()=>{
                            const itemEl = ctext.querySelector('.citem');
                            const h = itemEl ? itemEl.offsetHeight : 48;
                            const snapIdx = Math.round(ctext.scrollTop / h);
                            ctext.scrollTo({ top: snapIdx * h, behavior:'smooth' });
                        }, 120);
                    }

                    // allow wheel to use native scrolling (no preventDefault) so browser momentum applies
                    ctext.addEventListener('scroll', onScroll, { passive:true });
                    // keyboard support
                    preview.addEventListener('keydown', (ev)=>{
                        const itemEl = ctext.querySelector('.citem');
                        const h = itemEl ? itemEl.offsetHeight : 48;
                        if(ev.key === 'ArrowDown' || ev.key === 'PageDown'){ ctext.scrollBy({ top: h, behavior:'smooth'}); ev.preventDefault(); }
                        if(ev.key === 'ArrowUp' || ev.key === 'PageUp'){ ctext.scrollBy({ top: -h, behavior:'smooth'}); ev.preventDefault(); }
                    });

                    // initialize view
                    ctext.scrollTop = 0;
                    updateMeta(0);
                })(card, d);
              });
          }
         renderGrid(dishes);

        // Search: prioritize matching names to top, keep others below
        const searchInp = document.getElementById('search');
        searchInp.addEventListener('input', (e)=>{
            const q = e.target.value.trim().toLowerCase();
            if(!q){ renderGrid(dishes); return; }
            const matched = [], other=[];
            for(const d of dishes){
                if(d.name.toLowerCase().includes(q)) matched.push(d); else other.push(d);
            }
            renderGrid([...matched, ...other]);
        });

        // Modal detail
        const modal = document.getElementById('modal');
        const dlgTitle = document.getElementById('dlgTitle');
        const dlgImg = document.getElementById('dlgImg');
        const dlgDesc = document.getElementById('dlgDesc');
        const dlgVars = document.getElementById('dlgVars');
        const dlgTops = document.getElementById('dlgTops');
        const dlgComments = document.getElementById('dlgComments');
        const dlgRating = document.getElementById('dlgRating');
        document.getElementById('closeDlg').addEventListener('click', ()=> modal.classList.remove('active'));
        modal.addEventListener('click', (e)=> { if(e.target===modal) modal.classList.remove('active'); });

        function starsHtml(n){
            const full = Math.round(n);
            return '★'.repeat(full) + '☆'.repeat(5-full) + ` <span style="color:#888;font-weight:600;margin-left:8px">${n.toFixed(1)}/5</span>`;
        }

        function openDish(id){
            const d = dishes.find(x=>x.id===id);
            if(!d) return;
            dlgTitle.textContent = d.name;
            dlgImg.src = d.img;
            dlgDesc.textContent = d.desc;
            dlgVars.innerHTML = d.variants.map(v=>`<div class="chip">${v}</div>`).join('');
            dlgTops.innerHTML = d.toppings.map(t=>`<div class="chip">${t}</div>`).join('');
            // show dish rating stars (synchronized with Reviews tab)
            dlgRating.innerHTML = starsHtml(d.rating);
            // render comments with reviewer name + avatar + star if available
            dlgComments.innerHTML = d.comments.map(c=>{
                const name = c.name || (String(c.text||'').split(/[.!?…]/)[0].split(' ').slice(0,2).join(' ')) || 'Người dùng';
                const initial = (name.trim().charAt(0) || 'U').toUpperCase();
                const rstars = (typeof c.rating === 'number') ? ('<div style="color:#f5a623;font-size:14px">'+ '★'.repeat(Math.round(c.rating)) + '☆'.repeat(5-Math.round(c.rating)) + '</div>') : '';
                return `<div class="cmt"><div style="display:flex;gap:10px;align-items:flex-start"><div style="width:40px;height:40px;border-radius:50%;background:linear-gradient(180deg,var(--accent),#5f9b6a);color:#fff;display:grid;place-items:center;font-weight:700">${initial}</div><div><strong>${escapeHtml(name)}</strong>${rstars}<div style="margin-top:6px;color:#333">${escapeHtml(c.text)}</div></div></div></div>`;
            }).join('');
            modal.classList.add('active');
        }

        // Reviews tab render
        const reviewList = document.getElementById('reviewList');
        function renderReviews(){
             reviewList.innerHTML = '';
             dishes.slice().forEach(d=>{
                 const r = document.createElement('div'); r.className='review-item';
                r.style.cursor = 'pointer';
                r.dataset.id = d.id;
                r.addEventListener('click', ()=> openDish(d.id)); // open dish details on click
                 const stars = '★'.repeat(Math.round(d.rating)) + '☆'.repeat(5 - Math.round(d.rating));
                 r.innerHTML = `<div><strong>${d.name}</strong><div style="color:#888;font-size:13px">${d.rating.toFixed(1)} / 5</div></div><div style="font-size:18px;color:#f5a623">${stars}</div>`;
                 reviewList.appendChild(r);
             });
         }
        renderReviews();

        // Accessibility: pause carousel on hover
        const carousel = document.getElementById('carousel');
        carousel.addEventListener('mouseenter', ()=> clearInterval(autoId));
        carousel.addEventListener('mouseleave', ()=> resetAuto());

        // initial reset auto to ensure timing
        resetAuto();

        // small utility to escape HTML in text content
        function escapeHtml(s){
            return String(s || '').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
        }
    </script>
</body>

</html>
